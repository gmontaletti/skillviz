% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/read_data.R
\name{deduplicate_annunci}
\alias{deduplicate_annunci}
\title{Deduplicate job announcements}
\usage{
deduplicate_annunci(ann, active_date = Sys.Date())
}
\arguments{
\item{ann}{A data.table of announcements. Must contain columns
\code{general_id}, \code{idcity}, \code{idesco_level_4}, and \code{xdata}.}

\item{active_date}{An IDate or Date cutoff: announcements with
\code{xdata >= active_date} are flagged as active. Defaults to
\code{Sys.Date()}.}
}
\value{
A data.table with one row per \code{general_id} and columns:
\code{general_id}, \code{N} (original row count), \code{idcity} (modal),
\code{idesco_level_4} (modal), \code{attivo} (1 if any row active, 0
otherwise).
}
\description{
Collapse duplicate rows sharing the same \code{general_id} into a
single row, keeping modal values for categorical columns via
\code{\link[collapse:fmode]{collapse::fmode()}} and computing an activity flag based on
\code{xdata}.
}
