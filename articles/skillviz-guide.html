<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Comprehensive Guide to skillviz • skillviz</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Comprehensive Guide to skillviz">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">skillviz</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/gmontaletti/skillviz"><span class="fa fa-github"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Comprehensive Guide to skillviz</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/gmontaletti/skillviz/blob/main/vignettes/skillviz-guide.Rmd" class="external-link"><code>vignettes/skillviz-guide.Rmd</code></a></small>
      <div class="d-none name"><code>skillviz-guide.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p><strong>skillviz</strong> is an R package for analyzing skill
requirements from Online Job Advertising (OJA) data. It provides a
coherent set of functions for computing skill specialization indices,
co-occurrence networks, source stability filtering, salary analysis,
professional distance clustering, and temporal skill ranking.</p>
<p>The package is built around two classification systems:</p>
<ul>
<li>
<strong>ESCO</strong> (European Skills, Competences, Qualifications
and Occupations) – the European multilingual taxonomy that classifies
occupations (ISCO-based) and skills in a hierarchical structure.</li>
<li>
<strong>CP2021</strong> (Classificazione delle Professioni 2021) –
the Italian national professional classification maintained by ISTAT,
structured at multiple digit levels (e.g., 3-digit groups).</li>
</ul>
<p>The analytical framework follows a pipeline approach: raw OJA records
are loaded, deduplicated, enriched with profession and skill labels
through crosswalk tables, and then processed through a series of
quantitative modules – from skill relevance computation to network
analysis and temporal tracking.</p>
<p>All core functions use <code>data.table</code> for data manipulation.
Optional visualization and time-series features depend on suggested
packages (ggplot2, ggraph, tsibble, etc.) that are checked at
runtime.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://gmontaletti.github.io/skillviz/">skillviz</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="data-preparation">Data Preparation<a class="anchor" aria-label="anchor" href="#data-preparation"></a>
</h2>
<p>The first step in any skillviz workflow is loading and cleaning the
raw OJA data. The package provides three functions for this purpose.</p>
<div class="section level3">
<h3 id="read_esco_mapping">read_esco_mapping()<a class="anchor" aria-label="anchor" href="#read_esco_mapping"></a>
</h3>
<p>Reads the CPI-to-ESCO level 4 mapping table from either a database
connection or an <code>.fst</code> file on disk. This mapping is used to
link job announcements (coded in ESCO) to the Italian professional
classification.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 1. read from fst file -----</span></span>
<span><span class="va">esco_mapping</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_esco_mapping.html">read_esco_mapping</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"path/to/mappa_cpv_esco_iv.fst"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 2. read from database -----</span></span>
<span><span class="co"># conn &lt;- DBI::dbConnect(RPostgres::Postgres(), ...)</span></span>
<span><span class="co"># esco_mapping &lt;- read_esco_mapping(conn = conn)</span></span></code></pre></div>
<p>The returned <code>data.table</code> contains at least these
columns:</p>
<table class="table">
<thead><tr class="header">
<th>Column</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>idesco_level_4</code></td>
<td>ESCO level 4 occupation code</td>
</tr>
<tr class="even">
<td><code>esco_level_4</code></td>
<td>ESCO level 4 occupation label (Italian)</td>
</tr>
<tr class="odd">
<td><code>idcp_2011_v</code></td>
<td>CP2011 code (used to derive <code>cod_3</code>)</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="read_isco_groups">read_isco_groups()<a class="anchor" aria-label="anchor" href="#read_isco_groups"></a>
</h3>
<p>Reads the <code>ISCOGroups*.csv</code> file from an ESCO
classification dataset directory. This provides the hierarchical
occupation structure.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">isco</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_isco_groups.html">read_isco_groups</a></span><span class="op">(</span><span class="st">"path/to/ESCO dataset - v1.1.1 - classification - it - csv"</span><span class="op">)</span></span></code></pre></div>
<p>The result is a <code>data.table</code> with columns including
<code>code</code> and <code>preferredLabel</code>.</p>
</div>
<div class="section level3">
<h3 id="deduplicate_annunci">deduplicate_annunci()<a class="anchor" aria-label="anchor" href="#deduplicate_annunci"></a>
</h3>
<p>Job announcements in OJA databases often contain duplicate rows per
<code>general_id</code>. This function collapses duplicates by keeping
modal values for categorical columns (via
<code><a href="https://fastverse.org/collapse/reference/fmode.html" class="external-link">collapse::fmode()</a></code>) and computing an activity flag.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 1. synthetic announcement data -----</span></span>
<span><span class="va">ann_raw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/data.table/man/data.table.html" class="external-link">data.table</a></span><span class="op">(</span></span>
<span>  general_id   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  idcity       <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">101</span>, <span class="fl">101</span>, <span class="fl">202</span>, <span class="fl">202</span>, <span class="fl">203</span>, <span class="fl">101</span><span class="op">)</span>,</span>
<span>  idesco_level_4 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"E001"</span>, <span class="st">"E001"</span>, <span class="st">"E002"</span>, <span class="st">"E002"</span>, <span class="st">"E002"</span>, <span class="st">"E001"</span><span class="op">)</span>,</span>
<span>  xdata        <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/data.table/man/IDateTime.html" class="external-link">as.IDate</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"2024-01-15"</span>, <span class="st">"2024-01-16"</span>, <span class="st">"2024-06-01"</span>,</span>
<span>                             <span class="st">"2024-06-02"</span>, <span class="st">"2024-06-03"</span>, <span class="st">"2024-12-01"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 2. deduplicate -----</span></span>
<span><span class="va">ann_dedup</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/deduplicate_annunci.html">deduplicate_annunci</a></span><span class="op">(</span><span class="va">ann_raw</span>, active_date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/data.table/man/IDateTime.html" class="external-link">as.IDate</a></span><span class="op">(</span><span class="st">"2024-11-01"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><strong>Output columns:</strong> <code>general_id</code>,
<code>N</code> (original row count), <code>idcity</code> (modal),
<code>idesco_level_4</code> (modal), <code>attivo</code> (1 if any row
is active, 0 otherwise).</p>
</div>
</div>
<div class="section level2">
<h2 id="classification-crosswalks">Classification Crosswalks<a class="anchor" aria-label="anchor" href="#classification-crosswalks"></a>
</h2>
<p>Once the mapping data is loaded, these functions link ESCO occupation
codes to CP2021 profession groups and enrich announcements with
geographic information.</p>
<div class="section level3">
<h3 id="build_cpi_esco_crosswalk">build_cpi_esco_crosswalk()<a class="anchor" aria-label="anchor" href="#build_cpi_esco_crosswalk"></a>
</h3>
<p>Merges the ESCO mapping with CP2021 level 3 classification to produce
a lookup table mapping each <code>idesco_level_4</code> to its Italian
ESCO label and CP2021 3-digit group.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 1. synthetic inputs -----</span></span>
<span><span class="va">esco_mapping</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/data.table/man/data.table.html" class="external-link">data.table</a></span><span class="op">(</span></span>
<span>  idesco_level_4 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"E001"</span>, <span class="st">"E002"</span>, <span class="st">"E003"</span><span class="op">)</span>,</span>
<span>  esco_level_4   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Software developer"</span>, <span class="st">"Data analyst"</span>, <span class="st">"System admin"</span><span class="op">)</span>,</span>
<span>  idcp_2011_v    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"2.1.1.4.1"</span>, <span class="st">"2.1.1.5.2"</span>, <span class="st">"2.1.1.4.3"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">cpi3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/data.table/man/data.table.html" class="external-link">data.table</a></span><span class="op">(</span></span>
<span>  cod_3  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"2.1.1"</span>, <span class="st">"2.1.2"</span><span class="op">)</span>,</span>
<span>  nome_3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ICT specialists"</span>, <span class="st">"Engineering technicians"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 2. build crosswalk -----</span></span>
<span><span class="va">crosswalk</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/build_cpi_esco_crosswalk.html">build_cpi_esco_crosswalk</a></span><span class="op">(</span><span class="va">esco_mapping</span>, <span class="va">cpi3</span><span class="op">)</span></span></code></pre></div>
<p><strong>Output columns:</strong> <code>idesco_level_4</code>,
<code>it_esco_level_4</code> (collapsed Italian labels),
<code>cod_3</code>, <code>nome_3</code>.</p>
</div>
<div class="section level3">
<h3 id="prepare_annunci_esco">prepare_annunci_esco()<a class="anchor" aria-label="anchor" href="#prepare_annunci_esco"></a>
</h3>
<p>Joins announcements with the ESCO mapping to add Italian profession
labels and parses year/month/day columns into proper <code>IDate</code>
fields.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 1. synthetic announcement data -----</span></span>
<span><span class="va">ann</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/data.table/man/data.table.html" class="external-link">data.table</a></span><span class="op">(</span></span>
<span>  general_id       <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  idesco_level_4   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"E001"</span>, <span class="st">"E002"</span>, <span class="st">"E001"</span><span class="op">)</span>,</span>
<span>  year_grab_date   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2024L</span>, <span class="fl">2024L</span>, <span class="fl">2024L</span><span class="op">)</span>,</span>
<span>  month_grab_date  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1L</span>, <span class="fl">3L</span>, <span class="fl">6L</span><span class="op">)</span>,</span>
<span>  day_grab_date    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">15L</span>, <span class="fl">10L</span>, <span class="fl">20L</span><span class="op">)</span>,</span>
<span>  year_expire_date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2024L</span>, <span class="fl">2024L</span>, <span class="fl">2024L</span><span class="op">)</span>,</span>
<span>  month_expire_date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2L</span>, <span class="fl">4L</span>, <span class="fl">7L</span><span class="op">)</span>,</span>
<span>  day_expire_date  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">15L</span>, <span class="fl">10L</span>, <span class="fl">20L</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 2. prepare -----</span></span>
<span><span class="va">ann_esco</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prepare_annunci_esco.html">prepare_annunci_esco</a></span><span class="op">(</span><span class="va">ann</span>, <span class="va">esco_mapping</span><span class="op">)</span></span></code></pre></div>
<p><strong>Output columns:</strong> <code>general_id</code>,
<code>gdate</code> (grab date as IDate), <code>idesco_level_4</code>,
<code>it_esco_level_4</code>.</p>
</div>
<div class="section level3">
<h3 id="prepare_annunci_geography">prepare_annunci_geography()<a class="anchor" aria-label="anchor" href="#prepare_annunci_geography"></a>
</h3>
<p>Merges announcements with both ESCO labels and a territorial mapping
table to add the CPI (Centro per l’Impiego) dimension, then aggregates
unique announcement counts by CPI, profession, and year.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 1. territorial table -----</span></span>
<span><span class="va">territoriale</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/data.table/man/data.table.html" class="external-link">data.table</a></span><span class="op">(</span></span>
<span>  COD_ISTAT       <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">101L</span>, <span class="fl">202L</span>, <span class="fl">303L</span><span class="op">)</span>,</span>
<span>  CPI             <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CPI Trento"</span>, <span class="st">"CPI Rovereto"</span>, <span class="st">"CPI Riva"</span><span class="op">)</span>,</span>
<span>  COD_REGIONE_PAUT <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10L</span>, <span class="fl">10L</span>, <span class="fl">10L</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 2. prepare with geographic dimension -----</span></span>
<span><span class="va">ann_geo</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prepare_annunci_geography.html">prepare_annunci_geography</a></span><span class="op">(</span></span>
<span>  <span class="va">ann</span>, <span class="va">esco_mapping</span>, <span class="va">territoriale</span>, regione <span class="op">=</span> <span class="fl">10L</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><strong>Output columns:</strong> <code>CPI</code>,
<code>it_esco_level_4</code>, <code>year_grab_date</code>,
<code>N</code>.</p>
</div>
</div>
<div class="section level2">
<h2 id="skill-relevance-analysis">Skill Relevance Analysis<a class="anchor" aria-label="anchor" href="#skill-relevance-analysis"></a>
</h2>
<p>This module provides methods for measuring how relevant or specific a
skill is to a given profession. The core concepts are the Balassa index
(Revealed Comparative Advantage) and TF-IDF-based diffusion
classification.</p>
<div class="section level3">
<h3 id="compute_balassa_index">compute_balassa_index()<a class="anchor" aria-label="anchor" href="#compute_balassa_index"></a>
</h3>
<p>The <strong>Balassa index</strong> (also known as Revealed
Comparative Advantage, RCA) is a standard measure from international
trade economics, adapted here to skill analysis. For a profession-skill
pair, the index computes:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mo>=</mo><mfrac><mrow><msub><mi>N</mi><mrow><mi>s</mi><mi>k</mi><mi>i</mi><mi>l</mi><mi>l</mi><mo>,</mo><mi>p</mi><mi>r</mi><mi>o</mi><mi>f</mi></mrow></msub><mi>/</mi><msub><mi>N</mi><mrow><mi>p</mi><mi>r</mi><mi>o</mi><mi>f</mi></mrow></msub></mrow><mrow><msub><mi>N</mi><mrow><mi>s</mi><mi>k</mi><mi>i</mi><mi>l</mi><mi>l</mi><mo>,</mo><mi>a</mi><mi>l</mi><mi>l</mi></mrow></msub><mi>/</mi><msub><mi>N</mi><mrow><mi>a</mi><mi>l</mi><mi>l</mi></mrow></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">B = \frac{N_{skill,prof} / N_{prof}}{N_{skill,all} / N_{all}}</annotation></semantics></math></p>
<p>A value of B &gt;= 1 indicates the skill is over-represented in that
profession relative to its overall frequency – i.e., the skill is
“specific” to the profession.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 1. synthetic skill occurrence data -----</span></span>
<span><span class="va">skills</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/data.table/man/data.table.html" class="external-link">data.table</a></span><span class="op">(</span></span>
<span>  preferredLabel    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Software developer"</span>, <span class="fl">5</span><span class="op">)</span>,</span>
<span>                        <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Data analyst"</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>                        <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Software developer"</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  escoskill_level_3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Python"</span>, <span class="st">"Java"</span>, <span class="st">"SQL"</span>, <span class="st">"Docker"</span>, <span class="st">"Git"</span>,</span>
<span>                        <span class="st">"Python"</span>, <span class="st">"SQL"</span>, <span class="st">"Statistics"</span>, <span class="st">"Excel"</span>,</span>
<span>                        <span class="st">"Python"</span>, <span class="st">"Java"</span>, <span class="st">"Docker"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 2. compute Balassa index -----</span></span>
<span><span class="va">balassa</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compute_balassa_index.html">compute_balassa_index</a></span><span class="op">(</span><span class="va">skills</span><span class="op">)</span></span></code></pre></div>
<p><strong>Output columns:</strong> <code>preferredLabel</code>,
<code>escoskill_level_3</code>, <code>N</code>,
<code>tutte_professioni</code>,
<code>tutte_le_skills_della_professione</code>,
<code>tutte_le_ricorrenze</code>, <code>balassa_index</code>,
<code>specializzazione</code> (“specifica” if B &gt;= 1, “non specifica”
otherwise).</p>
</div>
<div class="section level3">
<h3 id="compute_skill_diffusion">compute_skill_diffusion()<a class="anchor" aria-label="anchor" href="#compute_skill_diffusion"></a>
</h3>
<p>This function applies a <strong>TF-IDF</strong> (Term Frequency -
Inverse Document Frequency) approach to classify skills by their
diffusion level. TF measures how frequently a skill appears relative to
total occurrences; IDF penalizes skills that appear everywhere by
computing <code>log(N_total / N_skill)</code>.</p>
<p>Skills with very low IDF (bottom quantile) are classified as “alta”
(highly diffuse/generic), while those with very high IDF (top quantile)
are “minima” (rare/niche).</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 1. aggregated skill frequencies -----</span></span>
<span><span class="va">skills_agg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/data.table/man/data.table.html" class="external-link">data.table</a></span><span class="op">(</span></span>
<span>  escoskill_level_3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Python"</span>, <span class="st">"Java"</span>, <span class="st">"SQL"</span>, <span class="st">"Docker"</span>,</span>
<span>                        <span class="st">"Statistics"</span>, <span class="st">"Excel"</span>, <span class="st">"Git"</span><span class="op">)</span>,</span>
<span>  N                 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">500L</span>, <span class="fl">300L</span>, <span class="fl">800L</span>, <span class="fl">150L</span>, <span class="fl">200L</span>, <span class="fl">700L</span>, <span class="fl">100L</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 2. compute diffusion -----</span></span>
<span><span class="va">diffusion</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compute_skill_diffusion.html">compute_skill_diffusion</a></span><span class="op">(</span><span class="va">skills_agg</span>, quantile_trim <span class="op">=</span> <span class="fl">0.025</span><span class="op">)</span></span></code></pre></div>
<p><strong>Output columns:</strong> <code>escoskill_level_3</code>,
<code>N</code>, <code>tf</code>, <code>idf</code>,
<code>diffusione</code> (“alta”, “centrale”, or “minima”).</p>
</div>
<div class="section level3">
<h3 id="build_skillist">build_skillist()<a class="anchor" aria-label="anchor" href="#build_skillist"></a>
</h3>
<p>Builds a master skills list by merging skill metadata (reuse type,
domain flags) with diffusion scores. The ESCO reuse type labels are
translated to Italian (<code>settoriale</code>,
<code>trasversale</code>, <code>specifico</code>,
<code>multisettoriale</code>).</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 1. skill metadata -----</span></span>
<span><span class="va">skill_meta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/data.table/man/data.table.html" class="external-link">data.table</a></span><span class="op">(</span></span>
<span>  escoskill_level_3     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Python"</span>, <span class="st">"Python"</span>, <span class="st">"SQL"</span>, <span class="st">"SQL"</span><span class="op">)</span>,</span>
<span>  esco_v0101_reusetype  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sector-specific"</span>, <span class="st">"sector-specific"</span>,</span>
<span>                            <span class="st">"transversal"</span>, <span class="st">"transversal"</span><span class="op">)</span>,</span>
<span>  pillar_softskills     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0L</span>, <span class="fl">0L</span>, <span class="fl">0L</span>, <span class="fl">0L</span><span class="op">)</span>,</span>
<span>  esco_v0101_ict        <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1L</span>, <span class="fl">1L</span>, <span class="fl">1L</span>, <span class="fl">1L</span><span class="op">)</span>,</span>
<span>  esco_v0101_green      <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0L</span>, <span class="fl">0L</span>, <span class="fl">0L</span>, <span class="fl">0L</span><span class="op">)</span>,</span>
<span>  esco_v0101_language   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0L</span>, <span class="fl">0L</span>, <span class="fl">0L</span>, <span class="fl">0L</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 2. build master list -----</span></span>
<span><span class="va">master_skills</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/build_skillist.html">build_skillist</a></span><span class="op">(</span><span class="va">skill_meta</span>, <span class="va">diffusion</span><span class="op">)</span></span></code></pre></div>
<p><strong>Output columns:</strong> <code>escoskill_level_3</code>,
<code>N</code>, <code>tf</code>, <code>idf</code>,
<code>diffusione</code>, <code>esco_v0101_reusetype</code>,
<code>pillar_softskills</code>, <code>esco_v0101_ict</code>,
<code>esco_v0101_green</code>, <code>esco_v0101_language</code>,
<code>tipo</code>.</p>
</div>
<div class="section level3">
<h3 id="compute_idf_classification">compute_idf_classification()<a class="anchor" aria-label="anchor" href="#compute_idf_classification"></a>
</h3>
<p>A variant of diffusion analysis that operates at the <strong>document
level</strong>. Instead of using aggregated counts, it computes IDF
based on the number of distinct announcements (documents) mentioning
each skill:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi><mi>D</mi><mi>F</mi><mo>=</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><msub><mi>N</mi><mrow><mi>d</mi><mi>o</mi><mi>c</mi><mi>s</mi><mi>_</mi><mi>t</mi><mi>o</mi><mi>t</mi><mi>a</mi><mi>l</mi></mrow></msub><msub><mi>N</mi><mrow><mi>d</mi><mi>o</mi><mi>c</mi><mi>s</mi><mi>_</mi><mi>w</mi><mi>i</mi><mi>t</mi><mi>h</mi><mi>_</mi><mi>s</mi><mi>k</mi><mi>i</mi><mi>l</mi><mi>l</mi></mrow></msub></mfrac><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">IDF = \log\left(\frac{N_{docs\_total}}{N_{docs\_with\_skill}}\right)</annotation></semantics></math></p>
<p>This is more robust to situations where a single announcement might
list the same skill multiple times.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 1. document-level skill data -----</span></span>
<span><span class="va">skills_merged</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/data.table/man/data.table.html" class="external-link">data.table</a></span><span class="op">(</span></span>
<span>  general_id        <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  escoskill_level_3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Python"</span>, <span class="st">"SQL"</span>, <span class="st">"Docker"</span>,</span>
<span>                        <span class="st">"Python"</span>, <span class="st">"SQL"</span>,</span>
<span>                        <span class="st">"Python"</span>, <span class="st">"Java"</span>, <span class="st">"SQL"</span>, <span class="st">"Git"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 2. compute IDF classification -----</span></span>
<span><span class="va">idf_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compute_idf_classification.html">compute_idf_classification</a></span><span class="op">(</span><span class="va">skills_merged</span>, quantile_trim <span class="op">=</span> <span class="fl">0.025</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 3. access components -----</span></span>
<span><span class="va">idf_result</span><span class="op">$</span><span class="va">idf</span>            <span class="co"># data.table with IDF scores</span></span>
<span><span class="va">idf_result</span><span class="op">$</span><span class="va">threshold_rows</span> <span class="co"># number of highly diffuse skills</span></span>
<span><span class="va">idf_result</span><span class="op">$</span><span class="va">diffuse_skills</span> <span class="co"># character vector of "alta" skills</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="co-occurrence-networks">Co-occurrence Networks<a class="anchor" aria-label="anchor" href="#co-occurrence-networks"></a>
</h2>
<p>Co-occurrence analysis identifies which skills tend to appear
together in the same job announcements. This module provides functions
for building co-occurrence matrices and filtering them to retain
statistically meaningful associations.</p>
<div class="section level3">
<h3 id="compute_cooc_matrix">compute_cooc_matrix()<a class="anchor" aria-label="anchor" href="#compute_cooc_matrix"></a>
</h3>
<p>Builds a sparse symmetric skill co-occurrence matrix using a
term-document matrix approach. The entry (i, j) counts how many
announcements mention both skill i and skill j.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 1. skill assignment data -----</span></span>
<span><span class="va">skills</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/data.table/man/data.table.html" class="external-link">data.table</a></span><span class="op">(</span></span>
<span>  general_id        <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  escoskill_level_3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Python"</span>, <span class="st">"SQL"</span>, <span class="st">"Docker"</span>,</span>
<span>                        <span class="st">"Python"</span>, <span class="st">"SQL"</span>,</span>
<span>                        <span class="st">"Python"</span>, <span class="st">"Java"</span>, <span class="st">"SQL"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 2. build co-occurrence matrix -----</span></span>
<span><span class="va">cooc_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compute_cooc_matrix.html">compute_cooc_matrix</a></span><span class="op">(</span><span class="va">skills</span><span class="op">)</span></span></code></pre></div>
<p>The result is a symmetric sparse matrix of class
<code>dgCMatrix</code> with skill names as row/column names.</p>
</div>
<div class="section level3">
<h3 id="filter_relative_risk">filter_relative_risk()<a class="anchor" aria-label="anchor" href="#filter_relative_risk"></a>
</h3>
<p>The raw co-occurrence matrix includes both meaningful and spurious
associations. <strong>Relative risk</strong> filtering retains only
edges where the observed co-occurrence exceeds the expected frequency
under independence:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mi>R</mi><mo>=</mo><mfrac><msub><mi>O</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><msub><mi>E</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mfrac><mo>=</mo><mfrac><mrow><msub><mi>O</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>×</mo><msub><mi>N</mi><mrow><mi>t</mi><mi>o</mi><mi>t</mi><mi>a</mi><mi>l</mi></mrow></msub></mrow><mrow><msub><mi>N</mi><mi>i</mi></msub><mo>×</mo><msub><mi>N</mi><mi>j</mi></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">RR = \frac{O_{ij}}{E_{ij}} = \frac{O_{ij} \times N_{total}}{N_i \times N_j}</annotation></semantics></math></p>
<p>Only pairs with RR &gt; 1 (observed count exceeds the independence
baseline) are kept.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 1. filter by relative risk -----</span></span>
<span><span class="va">rr_edges</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/filter_relative_risk.html">filter_relative_risk</a></span><span class="op">(</span><span class="va">cooc_mat</span><span class="op">)</span></span></code></pre></div>
<p><strong>Output columns:</strong> <code>from</code>, <code>to</code>,
<code>weight</code>, sorted by descending weight.</p>
</div>
<div class="section level3">
<h3 id="cooc_all_professions">cooc_all_professions()<a class="anchor" aria-label="anchor" href="#cooc_all_professions"></a>
</h3>
<p>Computes per-profession co-occurrence networks by iterating over each
profession, building a sparse term-document matrix, extracting
co-occurrence edges, and retaining the largest connected component.
Results are combined into a single <code>data.table</code>.</p>
<p>Internally, this function uses <code><a href="../reference/dot-cooc_single.html">.cooc_single()</a></code> which:</p>
<ol style="list-style-type: decimal">
<li>Filters data to a single profession.</li>
<li>Builds a sparse term-document matrix via <code><a href="https://rdrr.io/r/stats/xtabs.html" class="external-link">xtabs()</a></code>.</li>
<li>Computes co-occurrence via <code><a href="https://rdrr.io/pkg/Matrix/man/matmult-methods.html" class="external-link">Matrix::crossprod()</a></code>.</li>
<li>Applies a minimum weight threshold.</li>
<li>Retains the top-N edges and largest connected component.</li>
</ol>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 1. skill data with profession labels -----</span></span>
<span><span class="va">skills</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/data.table/man/data.table.html" class="external-link">data.table</a></span><span class="op">(</span></span>
<span>  general_id        <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">30</span>, each <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,</span>
<span>  escoskill_level_3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Python"</span>, <span class="st">"SQL"</span>, <span class="st">"Docker"</span>, <span class="st">"Java"</span>, <span class="st">"Git"</span><span class="op">)</span>,</span>
<span>                             <span class="fl">90</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  preferredLabel    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Developer"</span>, <span class="st">"Analyst"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">45</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 2. compute co-occurrence for all professions -----</span></span>
<span><span class="va">cooc_all</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cooc_all_professions.html">cooc_all_professions</a></span><span class="op">(</span></span>
<span>  <span class="va">skills</span>,</span>
<span>  top_n <span class="op">=</span> <span class="fl">20L</span>,</span>
<span>  min_weight <span class="op">=</span> <span class="fl">2L</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 3. compute for specific professions only -----</span></span>
<span><span class="va">cooc_dev</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cooc_all_professions.html">cooc_all_professions</a></span><span class="op">(</span></span>
<span>  <span class="va">skills</span>,</span>
<span>  professions <span class="op">=</span> <span class="st">"Developer"</span>,</span>
<span>  top_n <span class="op">=</span> <span class="fl">20L</span>,</span>
<span>  min_weight <span class="op">=</span> <span class="fl">2L</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><strong>Output columns:</strong> <code>professione</code>,
<code>from</code>, <code>to</code>, <code>weight</code>.</p>
</div>
</div>
<div class="section level2">
<h2 id="community-detection">Community Detection<a class="anchor" aria-label="anchor" href="#community-detection"></a>
</h2>
<p>Once a co-occurrence network is built, community detection algorithms
can identify groups of skills that cluster together. The package
supports four methods from the igraph library.</p>
<div class="section level3">
<h3 id="detect_skill_communities">detect_skill_communities()<a class="anchor" aria-label="anchor" href="#detect_skill_communities"></a>
</h3>
<p>Takes a co-occurrence edge list and applies a community detection
algorithm. The supported methods are:</p>
<table class="table">
<colgroup>
<col width="25%">
<col width="34%">
<col width="40%">
</colgroup>
<thead><tr class="header">
<th>Method</th>
<th>Algorithm</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>"infomap"</code></td>
<td>Information-theoretic</td>
<td>Minimizes the description length of a random walk (default)</td>
</tr>
<tr class="even">
<td><code>"label_prop"</code></td>
<td>Label propagation</td>
<td>Fast, non-deterministic propagation of labels</td>
</tr>
<tr class="odd">
<td><code>"walktrap"</code></td>
<td>Random walks</td>
<td>Uses short random walks to identify communities</td>
</tr>
<tr class="even">
<td><code>"spinglass"</code></td>
<td>Statistical mechanics</td>
<td>Spin-glass model, suitable for smaller graphs</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 1. co-occurrence edge list -----</span></span>
<span><span class="va">cooc_edges</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/data.table/man/data.table.html" class="external-link">data.table</a></span><span class="op">(</span></span>
<span>  from   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Python"</span>, <span class="st">"Python"</span>, <span class="st">"SQL"</span>, <span class="st">"Java"</span>, <span class="st">"Docker"</span>, <span class="st">"Docker"</span><span class="op">)</span>,</span>
<span>  to     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SQL"</span>, <span class="st">"Docker"</span>, <span class="st">"Docker"</span>, <span class="st">"Maven"</span>, <span class="st">"Kubernetes"</span>, <span class="st">"Linux"</span><span class="op">)</span>,</span>
<span>  weight <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">150</span>, <span class="fl">80</span>, <span class="fl">60</span>, <span class="fl">45</span>, <span class="fl">90</span>, <span class="fl">70</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 2. detect communities -----</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/detect_skill_communities.html">detect_skill_communities</a></span><span class="op">(</span><span class="va">cooc_edges</span>, method <span class="op">=</span> <span class="st">"infomap"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 3. access components -----</span></span>
<span><span class="va">result</span><span class="op">$</span><span class="va">graph</span>        <span class="co"># igraph object</span></span>
<span><span class="va">result</span><span class="op">$</span><span class="va">communities</span>  <span class="co"># community detection result</span></span>
<span><span class="va">result</span><span class="op">$</span><span class="va">membership</span>   <span class="co"># named integer vector: skill -&gt; community ID</span></span></code></pre></div>
<p>The <code>membership</code> vector can be used to color nodes in
network visualizations or to group skills into functional clusters for
reporting.</p>
</div>
</div>
<div class="section level2">
<h2 id="professional-distance-and-clustering">Professional Distance and Clustering<a class="anchor" aria-label="anchor" href="#professional-distance-and-clustering"></a>
</h2>
<p>These functions measure how similar or different professions are
based on their skill profiles, and group them into clusters.</p>
<div class="section level3">
<h3 id="compute_profession_distance">compute_profession_distance()<a class="anchor" aria-label="anchor" href="#compute_profession_distance"></a>
</h3>
<p>Builds a profession-by-skill incidence matrix and computes pairwise
distances between professions. The optional Balassa (RCA) filter zeros
out cells where the observed skill count is below expected, retaining
only skills that are over-represented in a profession.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 1. profession-skill data -----</span></span>
<span><span class="va">competenze</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/data.table/man/data.table.html" class="external-link">data.table</a></span><span class="op">(</span></span>
<span>  cod_3             <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"2.1.1"</span>, <span class="st">"2.1.1"</span>, <span class="st">"2.1.1"</span>, <span class="st">"2.1.2"</span>, <span class="st">"2.1.2"</span>, <span class="st">"2.1.2"</span><span class="op">)</span>,</span>
<span>  escoskill_level_3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Python"</span>, <span class="st">"SQL"</span>, <span class="st">"Docker"</span>, <span class="st">"Python"</span>, <span class="st">"SQL"</span>, <span class="st">"Statistics"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 2. compute distance -----</span></span>
<span><span class="va">dist_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compute_profession_distance.html">compute_profession_distance</a></span><span class="op">(</span><span class="va">competenze</span>, method <span class="op">=</span> <span class="st">"binary"</span><span class="op">)</span></span></code></pre></div>
<p>The default <code>"binary"</code> method treats the filtered matrix
as presence/absence and computes Jaccard-like distances. Other methods
supported by <code><a href="https://rdrr.io/r/stats/dist.html" class="external-link">stats::dist()</a></code> (e.g., <code>"euclidean"</code>,
<code>"canberra"</code>) can also be used.</p>
</div>
<div class="section level3">
<h3 id="cluster_professions">cluster_professions()<a class="anchor" aria-label="anchor" href="#cluster_professions"></a>
</h3>
<p>A wrapper around <code><a href="https://rdrr.io/r/stats/hclust.html" class="external-link">stats::hclust()</a></code> that performs
hierarchical clustering of the profession distance matrix. The resulting
dendrogram can be plotted or cut into groups with
<code><a href="https://rdrr.io/r/stats/cutree.html" class="external-link">stats::cutree()</a></code>.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 1. hierarchical clustering -----</span></span>
<span><span class="va">hc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cluster_professions.html">cluster_professions</a></span><span class="op">(</span><span class="va">dist_mat</span>, method <span class="op">=</span> <span class="st">"ward.D2"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 2. plot dendrogram -----</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">hc</span>, main <span class="op">=</span> <span class="st">"Profession clusters"</span>, xlab <span class="op">=</span> <span class="st">""</span>, sub <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 3. cut into k groups -----</span></span>
<span><span class="va">groups</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cutree.html" class="external-link">cutree</a></span><span class="op">(</span><span class="va">hc</span>, k <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="salary-analysis">Salary Analysis<a class="anchor" aria-label="anchor" href="#salary-analysis"></a>
</h2>
<p>This module extracts and summarizes salary information from job
announcements.</p>
<div class="section level3">
<h3 id="extract_salary_data">extract_salary_data()<a class="anchor" aria-label="anchor" href="#extract_salary_data"></a>
</h3>
<p>Filters announcements to those with a positive
<code>salaryvalue</code>.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 1. announcement data with salary -----</span></span>
<span><span class="va">ann_salary</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/data.table/man/data.table.html" class="external-link">data.table</a></span><span class="op">(</span></span>
<span>  general_id  <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,</span>
<span>  salaryvalue <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">35000</span>, <span class="fl">0</span>, <span class="fl">42000</span>, <span class="fl">0</span>, <span class="fl">55000</span><span class="op">)</span>,</span>
<span>  salary      <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"30000-40000"</span>, <span class="cn">NA</span>, <span class="st">"40000-45000"</span>, <span class="cn">NA</span>, <span class="st">"50000-60000"</span><span class="op">)</span>,</span>
<span>  data        <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/data.table/man/IDateTime.html" class="external-link">as.IDate</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"2024-01-15"</span>, <span class="st">"2024-02-10"</span>, <span class="st">"2024-03-20"</span>,</span>
<span>                           <span class="st">"2024-04-05"</span>, <span class="st">"2024-05-12"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 2. extract rows with salary -----</span></span>
<span><span class="va">sal</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract_salary_data.html">extract_salary_data</a></span><span class="op">(</span><span class="va">ann_salary</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="compute_salary_by_period">compute_salary_by_period()<a class="anchor" aria-label="anchor" href="#compute_salary_by_period"></a>
</h3>
<p>Aggregates salary statistics (count, mean, median) by grouping
columns. When <code>"mese"</code> is included in the grouping and does
not exist in the data, it is derived from the <code>data</code> column
as a <code>"YYYY-MM"</code> string.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 1. compute by salary band and month -----</span></span>
<span><span class="va">sal_period</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compute_salary_by_period.html">compute_salary_by_period</a></span><span class="op">(</span><span class="va">sal</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"salary"</span>, <span class="st">"mese"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><strong>Output columns:</strong> the <code>by</code> columns plus
<code>N</code>, <code>media</code> (mean), <code>mediana</code>
(median).</p>
</div>
<div class="section level3">
<h3 id="compute_salary_by_skill">compute_salary_by_skill()<a class="anchor" aria-label="anchor" href="#compute_salary_by_skill"></a>
</h3>
<p>Joins salary data with a skills table and computes the median salary
for each ESCO level 3 skill.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 1. skills table -----</span></span>
<span><span class="va">skills</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/data.table/man/data.table.html" class="external-link">data.table</a></span><span class="op">(</span></span>
<span>  general_id        <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">5</span><span class="op">)</span>,</span>
<span>  escoskill_level_3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Python"</span>, <span class="st">"SQL"</span>, <span class="st">"Python"</span>, <span class="st">"Docker"</span>, <span class="st">"SQL"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 2. median salary per skill -----</span></span>
<span><span class="va">sal_skill</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compute_salary_by_skill.html">compute_salary_by_skill</a></span><span class="op">(</span><span class="va">sal</span>, <span class="va">skills</span><span class="op">)</span></span></code></pre></div>
<p><strong>Output columns:</strong> <code>escoskill_level_3</code>,
<code>N</code>, <code>mediana</code> (median salary), sorted by
descending median.</p>
</div>
</div>
<div class="section level2">
<h2 id="source-stability-filtering">Source Stability Filtering<a class="anchor" aria-label="anchor" href="#source-stability-filtering"></a>
</h2>
<p>OJA data is collected from multiple online sources, each with
different coverage patterns. This module identifies and filters to
sources with stable temporal behavior, reducing bias from intermittent
or unreliable sources.</p>
<p>The pipeline involves four steps:</p>
<div class="section level3">
<h3 id="prepare_source_tsibble">prepare_source_tsibble()<a class="anchor" aria-label="anchor" href="#prepare_source_tsibble"></a>
</h3>
<p>Converts announcement data into a <code>tsibble</code> keyed by data
source (<code>fonte</code>) and indexed by year-month, counting unique
announcements per source per month.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 1. announcement data with source -----</span></span>
<span><span class="va">ann</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/data.table/man/data.table.html" class="external-link">data.table</a></span><span class="op">(</span></span>
<span>  general_id      <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">100</span>,</span>
<span>  source          <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Indeed"</span>, <span class="st">"LinkedIn"</span>, <span class="st">"Monster"</span><span class="op">)</span>, <span class="fl">100</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  gdate           <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/data.table/man/IDateTime.html" class="external-link">as.IDate</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/data.table/man/IDateTime.html" class="external-link">as.IDate</a></span><span class="op">(</span><span class="st">"2023-01-01"</span><span class="op">)</span>,</span>
<span>                                        <span class="fu"><a href="https://rdrr.io/pkg/data.table/man/IDateTime.html" class="external-link">as.IDate</a></span><span class="op">(</span><span class="st">"2024-12-31"</span><span class="op">)</span>,</span>
<span>                                        by <span class="op">=</span> <span class="st">"day"</span><span class="op">)</span>, <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 2. prepare tsibble -----</span></span>
<span><span class="va">tst</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prepare_source_tsibble.html">prepare_source_tsibble</a></span><span class="op">(</span><span class="va">ann</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="compute_source_features">compute_source_features()<a class="anchor" aria-label="anchor" href="#compute_source_features"></a>
</h3>
<p>Extracts time-series features from the tsibble using STL
decomposition (via <code><a href="https://feasts.tidyverts.org/reference/feat_stl.html" class="external-link">feasts::feat_stl()</a></code>). Returns mean,
standard deviation, total count, trend/seasonality strength, and
coefficient of variation (CV = sd / mean).</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 1. compute features -----</span></span>
<span><span class="va">features</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compute_source_features.html">compute_source_features</a></span><span class="op">(</span><span class="va">tst</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="filter_stable_sources">filter_stable_sources()<a class="anchor" aria-label="anchor" href="#filter_stable_sources"></a>
</h3>
<p>Selects sources whose coefficient of variation does not exceed a
threshold and whose total count meets a minimum. Lower CV indicates more
consistent publishing patterns.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 1. filter -----</span></span>
<span><span class="va">stable</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/filter_stable_sources.html">filter_stable_sources</a></span><span class="op">(</span><span class="va">features</span>, cv_threshold <span class="op">=</span> <span class="fl">0.6</span>, min_total <span class="op">=</span> <span class="fl">100L</span><span class="op">)</span></span></code></pre></div>
<p>The result is a character vector of stable source names.</p>
</div>
<div class="section level3">
<h3 id="filter_annunci_by_source">filter_annunci_by_source()<a class="anchor" aria-label="anchor" href="#filter_annunci_by_source"></a>
</h3>
<p>Subsets announcements to keep only rows from stable sources.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 1. filter announcements -----</span></span>
<span><span class="va">ann_stable</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/filter_annunci_by_source.html">filter_annunci_by_source</a></span><span class="op">(</span><span class="va">ann</span>, <span class="va">stable</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="temporal-analysis">Temporal Analysis<a class="anchor" aria-label="anchor" href="#temporal-analysis"></a>
</h2>
<p>This module tracks how skill demand evolves over time by computing
skill rankings within professions at each time period.</p>
<div class="section level3">
<h3 id="compute_skill_ranking_series">compute_skill_ranking_series()<a class="anchor" aria-label="anchor" href="#compute_skill_ranking_series"></a>
</h3>
<p>Aggregates skill counts by profession and time period (e.g., year,
quarter, month), then ranks skills within each profession-period
combination in descending order of count.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 1. skill-profession-date data -----</span></span>
<span><span class="va">competenze</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/data.table/man/data.table.html" class="external-link">data.table</a></span><span class="op">(</span></span>
<span>  escoskill_level_3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Python"</span>, <span class="st">"SQL"</span>, <span class="st">"Docker"</span>, <span class="st">"Python"</span>, <span class="st">"SQL"</span>,</span>
<span>                        <span class="st">"Python"</span>, <span class="st">"Java"</span>, <span class="st">"SQL"</span>, <span class="st">"Docker"</span>, <span class="st">"Git"</span><span class="op">)</span>,</span>
<span>  nome_3            <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"ICT specialists"</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>  gdate             <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/data.table/man/IDateTime.html" class="external-link">as.IDate</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"2023-03-15"</span>, <span class="fl">5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"2024-06-20"</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 2. compute annual ranking -----</span></span>
<span><span class="va">serie</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compute_skill_ranking_series.html">compute_skill_ranking_series</a></span><span class="op">(</span></span>
<span>  <span class="va">competenze</span>,</span>
<span>  time_unit <span class="op">=</span> <span class="st">"year"</span>,</span>
<span>  cutoff_date <span class="op">=</span> <span class="st">"2025-01-01"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><strong>Output columns:</strong> <code>professione</code>,
<code>mese</code> (floored date), <code>skill</code>, <code>N</code>
(count), <code>rango</code> (rank, 1 = most frequent).</p>
</div>
<div class="section level3">
<h3 id="compute_skill_variation">compute_skill_variation()<a class="anchor" aria-label="anchor" href="#compute_skill_variation"></a>
</h3>
<p>Computes year-over-year (or period-over-period) changes in skill
rankings. The variation is calculated as
<code>previous_rank - current_rank</code>, so positive values indicate
improvement (the skill moved to a higher rank).</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 1. compute variation -----</span></span>
<span><span class="va">variation</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compute_skill_variation.html">compute_skill_variation</a></span><span class="op">(</span></span>
<span>  <span class="va">serie</span>,</span>
<span>  min_n  <span class="op">=</span> <span class="fl">2L</span>,    <span class="co"># minimum count in current period</span></span>
<span>  top_k  <span class="op">=</span> <span class="fl">5L</span>     <span class="co"># top skills per profession</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><strong>Output:</strong> A wide-format <code>data.table</code> with
one row per profession-skill pair, rank and count columns for each
period (<code>rango_&lt;period&gt;</code>,
<code>N_&lt;period&gt;</code>), and <code>variazione</code> (rank
change).</p>
</div>
</div>
<div class="section level2">
<h2 id="skill-extraction">Skill Extraction<a class="anchor" aria-label="anchor" href="#skill-extraction"></a>
</h2>
<p>These functions combine the crosswalk, IDF classification, and merge
logic into higher-level extraction pipelines.</p>
<div class="section level3">
<h3 id="extract_specific_skills_cpi3">extract_specific_skills_cpi3()<a class="anchor" aria-label="anchor" href="#extract_specific_skills_cpi3"></a>
</h3>
<p>Extracts non-diffuse (specific) skills at the CP2021 3-digit
profession level. The pipeline:</p>
<ol style="list-style-type: decimal">
<li>Merges announcements with the CPI-ESCO crosswalk on
<code>idesco_level_4</code>.</li>
<li>Merges with skills on <code>general_id</code>.</li>
<li>Computes document-level IDF classification.</li>
<li>Filters out highly diffuse skills, retaining only “specifiche”
(specific) skills.</li>
</ol>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 1. synthetic data -----</span></span>
<span><span class="va">ann</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/data.table/man/data.table.html" class="external-link">data.table</a></span><span class="op">(</span></span>
<span>  general_id     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">5</span><span class="op">)</span>,</span>
<span>  idesco_level_4 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"E001"</span>, <span class="st">"E001"</span>, <span class="st">"E002"</span>, <span class="st">"E002"</span>, <span class="st">"E001"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">ski</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/data.table/man/data.table.html" class="external-link">data.table</a></span><span class="op">(</span></span>
<span>  general_id        <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">5</span><span class="op">)</span>,</span>
<span>  escoskill_level_3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Python"</span>, <span class="st">"SQL"</span>, <span class="st">"Python"</span>, <span class="st">"Docker"</span>,</span>
<span>                        <span class="st">"SQL"</span>, <span class="st">"Statistics"</span>, <span class="st">"SQL"</span>, <span class="st">"Python"</span>, <span class="st">"Java"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">cpi_esco</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/data.table/man/data.table.html" class="external-link">data.table</a></span><span class="op">(</span></span>
<span>  idesco_level_4 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"E001"</span>, <span class="st">"E002"</span><span class="op">)</span>,</span>
<span>  cod_3          <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"2.1.1"</span>, <span class="st">"2.1.2"</span><span class="op">)</span>,</span>
<span>  nome_3         <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ICT specialists"</span>, <span class="st">"Engineering technicians"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 2. extract specific skills -----</span></span>
<span><span class="va">specific</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract_specific_skills_cpi3.html">extract_specific_skills_cpi3</a></span><span class="op">(</span><span class="va">ann</span>, <span class="va">ski</span>, <span class="va">cpi_esco</span>, quantile_trim <span class="op">=</span> <span class="fl">0.025</span><span class="op">)</span></span></code></pre></div>
<p><strong>Output columns:</strong> <code>general_id</code>,
<code>escoskill_level_3</code>, <code>cod_3</code>,
<code>nome_3</code>.</p>
</div>
<div class="section level3">
<h3 id="build_profession_skill_profile">build_profession_skill_profile()<a class="anchor" aria-label="anchor" href="#build_profession_skill_profile"></a>
</h3>
<p>Builds a comprehensive profession-skill profile table by joining
announcements, skills, ISCO classification, and the master skills list.
Aggregates to the profession-skill level with unique announcement
counts.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 1. inputs -----</span></span>
<span><span class="va">ann</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/data.table/man/data.table.html" class="external-link">data.table</a></span><span class="op">(</span></span>
<span>  general_id     <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>,</span>
<span>  idesco_level_4 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"E001"</span>, <span class="st">"E001"</span>, <span class="st">"E002"</span>, <span class="st">"E002"</span><span class="op">)</span>,</span>
<span>  gdate          <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/data.table/man/IDateTime.html" class="external-link">as.IDate</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"2024-01-01"</span>, <span class="st">"2024-02-01"</span>,</span>
<span>                              <span class="st">"2024-03-01"</span>, <span class="st">"2024-04-01"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  edate          <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/data.table/man/IDateTime.html" class="external-link">as.IDate</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"2024-02-01"</span>, <span class="st">"2024-03-01"</span>,</span>
<span>                              <span class="st">"2024-04-01"</span>, <span class="st">"2024-05-01"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">ski</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/data.table/man/data.table.html" class="external-link">data.table</a></span><span class="op">(</span></span>
<span>  general_id        <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>  escoskill_level_3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Python"</span>, <span class="st">"SQL"</span>, <span class="st">"Python"</span>, <span class="st">"SQL"</span>, <span class="st">"Stats"</span>, <span class="st">"SQL"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">isco</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/data.table/man/data.table.html" class="external-link">data.table</a></span><span class="op">(</span></span>
<span>  code           <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"E001"</span>, <span class="st">"E002"</span><span class="op">)</span>,</span>
<span>  preferredLabel <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Software developer"</span>, <span class="st">"Data analyst"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">skillist_dt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/data.table/man/data.table.html" class="external-link">data.table</a></span><span class="op">(</span></span>
<span>  escoskill_level_3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Python"</span>, <span class="st">"SQL"</span>, <span class="st">"Stats"</span><span class="op">)</span>,</span>
<span>  diffusione        <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"centrale"</span>, <span class="st">"alta"</span>, <span class="st">"minima"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 2. build profile -----</span></span>
<span><span class="va">profile</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/build_profession_skill_profile.html">build_profession_skill_profile</a></span><span class="op">(</span></span>
<span>  <span class="va">ann</span>, <span class="va">ski</span>, <span class="va">isco</span>, <span class="va">skillist_dt</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><strong>Output columns:</strong> <code>preferredLabel</code>,
<code>escoskill_level_3</code> (or <code>ESCOSKILL_LEVEL_3</code>),
<code>diffusione</code>, <code>annunci</code>.</p>
</div>
</div>
<div class="section level2">
<h2 id="visualization">Visualization<a class="anchor" aria-label="anchor" href="#visualization"></a>
</h2>
<p>The package provides two plotting functions, both requiring suggested
packages (ggplot2, ggraph, tidygraph).</p>
<div class="section level3">
<h3 id="plot_cooc_graph">plot_cooc_graph()<a class="anchor" aria-label="anchor" href="#plot_cooc_graph"></a>
</h3>
<p>Renders a skill co-occurrence network graph using
<code>ggraph</code>. Edge width and transparency scale with
co-occurrence weight. Only the largest connected component is
plotted.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 1. co-occurrence edge list -----</span></span>
<span><span class="va">cooc_edges</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/data.table/man/data.table.html" class="external-link">data.table</a></span><span class="op">(</span></span>
<span>  from   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Python"</span>, <span class="st">"Python"</span>, <span class="st">"SQL"</span>, <span class="st">"Docker"</span>, <span class="st">"Docker"</span><span class="op">)</span>,</span>
<span>  to     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SQL"</span>, <span class="st">"Docker"</span>, <span class="st">"Docker"</span>, <span class="st">"Kubernetes"</span>, <span class="st">"Linux"</span><span class="op">)</span>,</span>
<span>  weight <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">150</span>, <span class="fl">80</span>, <span class="fl">60</span>, <span class="fl">90</span>, <span class="fl">70</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 2. plot network -----</span></span>
<span><span class="fu"><a href="../reference/plot_cooc_graph.html">plot_cooc_graph</a></span><span class="op">(</span><span class="va">cooc_edges</span>, profession <span class="op">=</span> <span class="st">"Software developer"</span>, layout <span class="op">=</span> <span class="st">"fr"</span><span class="op">)</span></span></code></pre></div>
<p>The <code>layout</code> parameter accepts any layout algorithm
supported by <code>ggraph</code> (e.g., <code>"fr"</code>,
<code>"kk"</code>, <code>"stress"</code>, <code>"circle"</code>).</p>
</div>
<div class="section level3">
<h3 id="plot_skill_ranking">plot_skill_ranking()<a class="anchor" aria-label="anchor" href="#plot_skill_ranking"></a>
</h3>
<p>Draws a line chart showing how skill ranks evolve over time for a
single profession. When <code>skills = NULL</code>, the function
automatically selects the 10 most frequently occurring skills.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 1. ranking series -----</span></span>
<span><span class="va">serie</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/data.table/man/data.table.html" class="external-link">data.table</a></span><span class="op">(</span></span>
<span>  mese         <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"2022-01-01"</span>, <span class="st">"2023-01-01"</span>, <span class="st">"2024-01-01"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                     each <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,</span>
<span>  skill        <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Python"</span>, <span class="st">"SQL"</span>, <span class="st">"Docker"</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  rango        <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>  N            <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">90</span>, <span class="fl">50</span>, <span class="fl">110</span>, <span class="fl">120</span>, <span class="fl">55</span>, <span class="fl">130</span>, <span class="fl">115</span>, <span class="fl">40</span><span class="op">)</span>,</span>
<span>  professione  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Software developer"</span>, <span class="fl">9</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 2. plot ranking evolution -----</span></span>
<span><span class="fu"><a href="../reference/plot_skill_ranking.html">plot_skill_ranking</a></span><span class="op">(</span><span class="va">serie</span>, profession <span class="op">=</span> <span class="st">"Software developer"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 3. plot specific skills only -----</span></span>
<span><span class="fu"><a href="../reference/plot_skill_ranking.html">plot_skill_ranking</a></span><span class="op">(</span><span class="va">serie</span>, profession <span class="op">=</span> <span class="st">"Software developer"</span>,</span>
<span>                   skills <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Python"</span>, <span class="st">"SQL"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="included-datasets">Included Datasets<a class="anchor" aria-label="anchor" href="#included-datasets"></a>
</h2>
<p>The package ships with three pre-computed datasets, available via
<code><a href="https://rdrr.io/r/utils/data.html" class="external-link">data()</a></code>.</p>
<div class="section level3">
<h3 id="isco_gruppi">isco_gruppi<a class="anchor" aria-label="anchor" href="#isco_gruppi"></a>
</h3>
<p>ESCO ISCO group classification mapping occupation codes to profession
names and hierarchy labels.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">isco_gruppi</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th>Column</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>code</code></td>
<td>ESCO occupation code</td>
</tr>
<tr class="even">
<td><code>preferredLabel</code></td>
<td>Profession name (Italian)</td>
</tr>
<tr class="odd">
<td><code>esco_v0101_hier_label_1</code></td>
<td>Hierarchy level 1</td>
</tr>
<tr class="even">
<td><code>esco_v0101_hier_label_2</code></td>
<td>Hierarchy level 2</td>
</tr>
<tr class="odd">
<td><code>esco_v0101_hier_label_3</code></td>
<td>Hierarchy level 3</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="skillist">skillist<a class="anchor" aria-label="anchor" href="#skillist"></a>
</h3>
<p>Pre-computed master skills list with frequency, reuse type, and
domain flags.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">skillist</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="38%">
<col width="61%">
</colgroup>
<thead><tr class="header">
<th>Column</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>escoskill_level_3</code></td>
<td>Skill identifier (ESCO level 3)</td>
</tr>
<tr class="even">
<td><code>esco_v0101_reusetype</code></td>
<td>Reuse type (sector-specific, transversal, occupation-specific,
multisettoriale)</td>
</tr>
<tr class="odd">
<td><code>N</code></td>
<td>Recurrence count</td>
</tr>
<tr class="even">
<td><code>tipo</code></td>
<td>Italian type label</td>
</tr>
<tr class="odd">
<td><code>pillar_softskills</code></td>
<td>Soft-skill flag</td>
</tr>
<tr class="even">
<td><code>esco_v0101_ict</code></td>
<td>ICT skill flag</td>
</tr>
<tr class="odd">
<td><code>esco_v0101_green</code></td>
<td>Green skill flag</td>
</tr>
<tr class="even">
<td><code>esco_v0101_language</code></td>
<td>Language skill flag</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="cooccorrenza">cooccorrenza<a class="anchor" aria-label="anchor" href="#cooccorrenza"></a>
</h3>
<p>Pre-computed global skill co-occurrence edges with relative-risk
filtering applied.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">cooccorrenza</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th>Column</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>from</code></td>
<td>First skill in the pair</td>
</tr>
<tr class="even">
<td><code>to</code></td>
<td>Second skill in the pair</td>
</tr>
<tr class="odd">
<td><code>weight</code></td>
<td>Co-occurrence count (relative risk &gt; 1)</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level2">
<h2 id="typical-workflow">Typical Workflow<a class="anchor" aria-label="anchor" href="#typical-workflow"></a>
</h2>
<p>The following outlines a complete end-to-end pipeline using skillviz
functions.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://gmontaletti.github.io/skillviz/">skillviz</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 1. load reference data -----</span></span>
<span><span class="va">esco_mapping</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_esco_mapping.html">read_esco_mapping</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"mappa_cpv_esco_iv.fst"</span><span class="op">)</span></span>
<span><span class="va">isco</span>         <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_isco_groups.html">read_isco_groups</a></span><span class="op">(</span><span class="st">"ESCO dataset - v1.1.1 - classification - it - csv"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 2. load and deduplicate announcements -----</span></span>
<span><span class="co"># ann_raw &lt;- fst::read_fst("announcements.fst", as.data.table = TRUE)</span></span>
<span><span class="co"># ann     &lt;- deduplicate_annunci(ann_raw, active_date = as.IDate("2024-01-01"))</span></span>
<span></span>
<span><span class="co"># 3. build crosswalk -----</span></span>
<span><span class="co"># cpi3      &lt;- fst::read_fst("cpi3.fst", as.data.table = TRUE)</span></span>
<span><span class="co"># crosswalk &lt;- build_cpi_esco_crosswalk(esco_mapping, cpi3)</span></span>
<span></span>
<span><span class="co"># 4. enrich announcements -----</span></span>
<span><span class="co"># ann_esco &lt;- prepare_annunci_esco(ann_raw, esco_mapping)</span></span>
<span></span>
<span><span class="co"># 5. source stability filtering -----</span></span>
<span><span class="co"># tst      &lt;- prepare_source_tsibble(ann_raw)</span></span>
<span><span class="co"># features &lt;- compute_source_features(tst)</span></span>
<span><span class="co"># stable   &lt;- filter_stable_sources(features, cv_threshold = 0.6, min_total = 100)</span></span>
<span><span class="co"># ann_filt &lt;- filter_annunci_by_source(ann_raw, stable)</span></span>
<span></span>
<span><span class="co"># 6. skill relevance -----</span></span>
<span><span class="co"># balassa   &lt;- compute_balassa_index(skills)</span></span>
<span><span class="co"># diffusion &lt;- compute_skill_diffusion(skills_agg)</span></span>
<span><span class="co"># master    &lt;- build_skillist(skills, diffusion)</span></span>
<span></span>
<span><span class="co"># 7. co-occurrence networks -----</span></span>
<span><span class="co"># cooc_mat  &lt;- compute_cooc_matrix(skills)</span></span>
<span><span class="co"># rr_edges  &lt;- filter_relative_risk(cooc_mat)</span></span>
<span><span class="co"># cooc_prof &lt;- cooc_all_professions(skills, top_n = 30L, min_weight = 10L)</span></span>
<span></span>
<span><span class="co"># 8. community detection -----</span></span>
<span><span class="co"># communities &lt;- detect_skill_communities(rr_edges, method = "infomap")</span></span>
<span></span>
<span><span class="co"># 9. professional distance and clustering -----</span></span>
<span><span class="co"># dist_mat &lt;- compute_profession_distance(competenze, method = "binary")</span></span>
<span><span class="co"># hc       &lt;- cluster_professions(dist_mat, method = "ward.D2")</span></span>
<span></span>
<span><span class="co"># 10. salary analysis -----</span></span>
<span><span class="co"># sal       &lt;- extract_salary_data(ann_raw)</span></span>
<span><span class="co"># sal_skill &lt;- compute_salary_by_skill(sal, skills)</span></span>
<span></span>
<span><span class="co"># 11. temporal analysis -----</span></span>
<span><span class="co"># serie     &lt;- compute_skill_ranking_series(competenze, time_unit = "year")</span></span>
<span><span class="co"># variation &lt;- compute_skill_variation(serie, min_n = 30L, top_k = 10L)</span></span>
<span></span>
<span><span class="co"># 12. visualization -----</span></span>
<span><span class="co"># plot_cooc_graph(rr_edges, profession = "Software developer")</span></span>
<span><span class="co"># plot_skill_ranking(serie, profession = "ICT specialists")</span></span></code></pre></div>
<p>The pipeline is modular: each step produces a <code>data.table</code>
(or igraph/dist object) that feeds into the next step. This design
supports both interactive exploration and integration with workflow
managers such as <a href="https://docs.ropensci.org/targets/" class="external-link">targets</a>.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Giampaolo Montaletti.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
